---
import PageLayout from '@/layouts/PageLayout.astro';

export async function getStaticPaths() {
  const pages = [
    {
      slug: 'governance',
      fileName: 'governance.md',
      title: 'Governance',
    },
    {
      slug: 'contributing',
      fileName: 'contribution.md',
      title: 'Contributing',
    },
  ];

  return pages.map(({ slug, fileName, title }) => ({
    params: { slug },
    props: { fileName, title },
  }));
}

const { fileName, title } = Astro.props;

// Use import.meta.glob to load the markdown files from the specs directory
// We need to use the relative path from this file to the specs directory
const allSpecs = import.meta.glob<import('astro').MarkdownInstance<Record<string, unknown>>>(
  '../../../../specs/*.md'
);
const specPath = `../../../../specs/${fileName}`;

const loader = allSpecs[specPath];
if (!loader) {
  throw new Error(`Spec file not found: ${specPath}`);
}

const post = await loader();
const { Content } = post;
---

<PageLayout title={title}>
  <article class="spec max-w-spec min-w-0 mx-auto p-md">
    <Content />
  </article>
</PageLayout>
